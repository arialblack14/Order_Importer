<% content_for :javascript do %>
  <script type="text/javascript">
    ShopifyApp.ready(function(){
      ShopifyApp.Bar.initialize({ title: "Home" });
    });
  </script>
<% end %>
<h2>Products</h2>

<ul>
  <% @products.each do |product| %>
    <li><%= link_to product.title, "https://#{@shop_session.url}/admin/products/#{product.id}", target: "_top" %></li>
  <% end %>
</ul>

<hr>
<p>The following are my products</p>
<table>
  <thead>
    <tr>
      <th>Product</th>
      <th>Name</th>
      <th>Price</th>
      <th>Description</th>
      <th>Specs</th>
      <th>Tags</th>
      <th>Permalink</th>
      <th>Position</th>
      <th>Cost</th>
      <th>Hts</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @my_products.each do |my_product| %>
      <tr>
        <td><%= my_product.product_id %></td>
        <td><%= my_product.name %></td>
        <td><%= my_product.price %></td>
        <td><%= my_product.description %></td>
        <td><%= my_product.specs %></td>
        <td><%= my_product.tags %></td>
        <td><%= my_product.permalink %></td>
        <td><%= my_product.position %></td>
        <td><%= my_product.cost %></td>
        <td><%= my_product.hts %></td>
        <td><%= link_to 'Show', my_product %></td>
        <td><%= link_to 'Edit', edit_my_product_path(my_product) %></td>
        <td><%= link_to 'Destroy', my_product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= form_tag import_my_products_path, multipart: true do %>
  <div>
    <%= link_to "Export CSV", my_products_path(format: "csv")%>
  </div>
  <div>
    <%= file_field_tag :file%>
  </div>
  
  <div>
    <%= submit_tag "Import CSV"%>
  </div>
<% end %>
<hr>

<h2>Webhooks</h2>

<% if @webhooks.present? %>
  <ul>
    <% @webhooks.each do |webhook| %>
      <li><%= webhook.topic %> : <%= webhook.address %></li>
    <% end %>
  </ul>
<% else %>
  <p>This app has not created any webhooks for this Shop. Add webhooks to your ShopifyApp initializer if you need webhooks</p>
<% end %>
